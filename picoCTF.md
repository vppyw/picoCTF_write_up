---
tags: CTF, picoCTF
---
# picoCTF

## Mod 26

<https://en.wikipedia.org/wiki/ROT13>
<https://rot13.com/>
flag: `picoCTF{next_time_I'll_try_2_rounds_of_rot13_wqWOSBKW}`

## Mind your Ps and Qs

<http://factordb.com/>

```python=
# values
Decrypt my super sick RSA:
c: 964354128913912393938480857590969826308054462950561875638492039363373779803642185
n: 1584586296183412107468474423529992275940096154074798537916936609523894209759157543
e: 65537
```

```python=
from Crypto.Util.number import inverse, long_to_bytes
n = 2434792384523484381583634042478415057961 *　650809615742055581459820253356987396346063 # factordb.com
p = 2434792384523484381583634042478415057961
q = 650809615742055581459820253356987396346063
e = 65535
d = inverse(e, (p - 1) * (q - 1))
long_tobytes(pow(c, d, n))
```

## Easy Peasy

<https://blog.maple3142.net/2021/03/30/picoctf-2021-writeups/>

```python=
# otp.py
#!/usr/bin/python3 -u
import os.path

KEY_FILE = "key"
KEY_LEN = 50000
FLAG_FILE = "flag"


def startup(key_location):
	flag = open(FLAG_FILE).read()
	kf = open(KEY_FILE, "rb").read()

	start = key_location
	stop = key_location + len(flag)

	key = kf[start:stop]
	key_location = stop

	result = list(map(lambda p, k: "{:02x}".format(ord(p) ^ k), flag, key))
	print("This is the encrypted flag!\n{}\n".format("".join(result)))

	return key_location

def encrypt(key_location):
	ui = input("What data would you like to encrypt? ").rstrip()
	if len(ui) == 0 or len(ui) > KEY_LEN:
		return -1

	start = key_location
	stop = key_location + len(ui)

	kf = open(KEY_FILE, "rb").read()

	if stop >= KEY_LEN:
		stop = stop % KEY_LEN
		key = kf[start:] + kf[:stop]
	else:
		key = kf[start:stop]
	key_location = stop

	result = list(map(lambda p, k: "{:02x}".format(ord(p) ^ k), ui, key))

	print("Here ya go!\n{}\n".format("".join(result)))

	return key_location


print("******************Welcome to our OTP implementation!******************")
c = startup(0)
while c >= 0:
	c = encrypt(c)
```

```python=
# send 50000 "0" to server get last 64 output
enc = bytes.fromhex("0345376e1e5406691d5c076c4050046e4000036a1a005c6b1904531d3941055d")
leak = bytes.fromhex("5217616c4853526c4808516c4852046c4800046c4856086c4800004b6c485454")
plain = b"0" * 32
bytes(a ^ b ^ c for a, b, c in zip(enc, leak, plain))
```

better solution with pwntools

```ptyhon=
from pwn import *
r = remote("mercury.picoctf.net", 41934)
_ = r.recvline()
_ = r.recvline()
enc = bytes.fromhex(r.recvline().decode())
enc_len = len(enc)
_ = r.sendlineafter(b"What data would you like to encrypt? ", b"0" * (50000 - enc_len))
_ = r.sendlineafter(b"What data would you like to encrypt? ", b"0" * enc_len)
_ = r.recvline()
leak = bytes.fromhex(r.recvline().decode())
print(f"picoCTF{{{bytes(a ^ b ^ c for a, b, c in zip(enc, leak, b'0' * enc_len)).decode()}}}")
```
flag: `picoCTF{abf2f7d5edf082028076bfd7a4cfe9a9}`

## The Numbers
![](https://i.imgur.com/jMf4H50.png)

```
"picoCTF{" + "".join(map(lambda x: chr(x + ord('a') - 1), [20,6,20,8,5,14,21,13,2,5,18,19,13,1,19,15,14])) + "}"
```

## New Caesar
```
import string

LOWER_OFFSET = ord("a")
ALPHABET = string.ascii_lowercase[:16]

enc = "ihjghbjgjhfbhbfcfjflfjiifdfgffihfeigidfligigffihfjfhfhfhigfjfffjfeihihfdieieih"
keys = ALPHABET
def shift(c, k):
    t1 = ord(c) - LOWER_OFFSET
    t2 = ord(k) - LOWER_OFFSET
    return ALPHABET[(t1 - t2 + len(ALPHABET)) % len(ALPHABET)]
def b16_encode(plain):
    enc = ""
    for c in plain:
        binary = "{0:08b}".format(ord(c))
        enc += ALPHABET[int(binary[:4], 2)]
        enc += ALPHABET[int(binary[4:], 2)]
    return enc
def b16_decode(enc):
    plain = ""
    for i in range(0, len(enc), 2):
        t1 = ord(enc[i]) - LOWER_OFFSET
        t2 = ord(enc[i + 1]) - LOWER_OFFSET
        plain += chr(int(f"{t1:04b}{t2:04b}", 2))
    return plain
for key in keys:
    dec = ""
    for c in enc:
        dec += shift(c, key)
    dec = b16_decode(dec)
    print(dec)
```

## Easy1
```
enc: UFJKXQZQUNB
key: SOLVECRYPTO
"".join((lambda c, k: chr((ord(c) - ord(k)) % 26 + ord('A')))(c, k) for c, k in zip("UFJKXQZQUNB", "SOLVECRYPTO"))
```
flag: `CRYPTOISFUN`

## 13
flag: `picoCTF{not_too_bad_of_a_problem}`

## caesar
```
enc = 'gvswwmrkxlivyfmgsrhnrisegl'
for i in range(26):
    ans = ''
    for c in enc:
        ans += chr((ord(c) - ord('a') + i) % 26 + ord('a'))
        print(ans)
```
flag: `picoCTF{crossingtherubicondjneoach}`

## Pixelated

<https://en.wikipedia.org/wiki/Visual_cryptography>

```python=
import cv2
p0 = cv2.imread('scramble1.png')
p1 = cv2.imread('scramble2.png')
cv2.imwrite('solv.png', p0 + p1)
```

flag: `picoCTF{2a4d45c7}`

## basic-mod1

```ptyhon=
enc = [54, 396, 131, 198, 225, 258, 87, 258, 128, 211, 57, 235, 114, 258, 144, 220, 39, 175, 330, 338, 297, 288]
''.join(key[i % 37] for i in enc)
```

flag: `picoCTF{R0UND_N_R0UND_79C18FB3}`

## basic-mod2

```ptyhon=
from Crypto.Util.number import *
enc = [268, 413, 110, 190, 426, 419, 108, 229, 310, 379, 323, 373, 385, 236, 92, 96, 169, 321, 284, 185, 154, 137, 186]
key = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_'
"".join(key[inverse(i % 41, 41)] for i in enc)
```

flag: `picoCTF{1NV3R53LY_H4RD_C680BDC1}`

## credstuff

```python=
import string
enc = 'cvpbPGS{P7e1S_54I35_71Z3}'
def dec(c);
    if c in string.ascii_lowercase:
        return chr((ord(c) - ord('a') + 13) % 26 + ord('a'))
    elif c in string.ascii_uppercase:
        return chr((ord(c) - ord('A') + 13) % 26 + ord('A'))
    return c
''.join(map(dec, enc))
```

flag: `picoCTF{C7r1F_54V35_71M3}`

## Mini RSA

```python=
from Crypto.Util.number import long_to_bytes
import gmpy2
N = 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
c = 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808146919581675891411119628108546342758721287307471723093546788074479139848242227243523617899178070097350912870635303707113283010669418774091018728233471491573736725568575532635111164176010070788796616348740261987121152288917179932230769893513971774137615028741237163693178359120276497700812698199245070488892892209716639870702721110338285426338729911942926177029934906215716407021792856449586278849142522957603215285531263079546937443583905937777298337318454706096366106704204777777913076793265584075700215822263709126228246232640662350759018119501368721990988895700497330256765579153834824063344973587990533626156498797388821484630786016515988383280196865544019939739447062641481267899176504155482
e = 3
for i in range(10000):
    m, flag = gmpy2.iroot(i * N + c, e)
    if flag:
        print(i, m)
        print(long_to_bytes(m))
        break
```

## Dachshund Attack

d 很小，Wiener's Attack

```python=
imoprt owiener
from Crypto.Util.number import long_to_bytes
n = 104915126201295565235871570184828461722123740132423673910984308523289644002794248132703185949203654911678982374620557316912117269968175108190337182721523034658182708775130666658391546515136265931956712366773944883839566001252723677484135590411886047209320143156288831777375746465704095042192709637649056548093
e = 1296925050580677377876949140928587747438488551678262698668021867857701416193087656698685384613398522499231098171751447941532779975188096871512673897257079924890117025767400002098958886944171416145703640124350706594639155614602209471329500247539199638356135103272320642314202472987495123797473655615647108127
c = 59111260106052564429410381947011270773813287409398511792390495100538916507566693150044956098535525031933090155050525603610697229391675650278445619601304108914700686173196747884866720491826201801045477421139570451390571243798445280464666433648124664173654497562253483620076398996763661587613204470465381070284
d = owiener.attack(e, n)
print(long_to_bytes(pow(c, d, n)))
```

## No Padding, No Problem

chosen chiphertext attack

```python=
from pwn import *
from Crypto.Util.number import long_to_bytes

r = remote("mercury.picoctf.net", 28517)
_ = r.recvline()
_ = r.recvline()
_ = r.recvline()
_ = r.recvline()
n = int(r.recvline().split(b':')[-1])
e = int(r.recvline().split(b':')[-1])
c = int(r.recvline().split(b':')[-1])
_ = r.sendlineafter(b'Give me ciphertext to decrypt: ', f"{(pow(2, e, n) * c) % n}".encode())
chosen_chipher = int(r.recvline().split(b':')[-1])
print(long_to_bytes(chosen_chipher // 2))
r.close()
```

## rail-fence

<https://www.dcode.fr/rail-fence-cipher>

## substitution0

```python=
d = {k:val for k, val in zip("EKSZJTCMXOQUDYLFABGPHNRVIW", "ABCDEFGHIJKLMNOPQRSTUVWXYZ")}
"".join([d[c] if c in d.keys() else c for c in "SPT{5HK5717H710Y_3N0UH710Y_59533E2J}"])
```

## substitution1

```python=
s = 'IECj (jqfue cfu ixzelus eqs coxa) xus x emzs fc ifrzlesu jsiludem ifrzsededfy. Ifyesjexyej xus zusjsyesk hdeq x jse fc iqxoosyasj hqdiq esje eqsdu iusxedgdem, esiqydixo (xyk affaodya) jpdooj, xyk zuftosr-jfogdya xtdodem. Iqxoosyasj ljlxoom ifgsu x ylrtsu fc ixesafudsj, xyk hqsy jfogsk, sxiq mdsokj x jeudya (ixoosk x coxa) hqdiq dj jltrdeesk ef xy fyodys jifudya jsugdis. IECj xus x ausxe hxm ef osxuy x hdks xuuxm fc ifrzlesu jsiludem jpdooj dy x jxcs, osaxo sygdufyrsye, xyk xus qfjesk xyk zoxmsk tm rxym jsiludem auflzj xuflyk eqs hfuok cfu cly xyk zuxiedis. Cfu eqdj zuftosr, eqs coxa dj: zdifIEC{CU3NL3YIM_4774IP5_4U3_I001_4871S6CT}'
d = {'a': 'g', 'b': 'b', 'c': 'f', 'd': 'i', 'e': 't', 'f': 'o', 'g': 'v', 'h': 'w', 'i': 'c', 'j': 's', 'k': 'd', 'l': 'u', 'm': 'y', 'n': 'q', 'o': 'l', 'p': 'k', 'q': 'h', 'r': 'm', 's': 'e', 't': 'b', 'u': 'r', 'v': 'v', 'w': 'w', 'x': 'a', 'y': 'n', 'z': 'p', 'A': 'G', 'B': 'B', 'C': 'F', 'D': 'I', 'E': 'T', 'F': 'O', 'G': 'V', 'H': 'W', 'I': 'C', 'J': 'S', 'K': 'D', 'L': 'U', 'M': 'Y', 'N': 'Q', 'O': 'L', 'P': 'K', 'Q': 'H', 'R': 'M', 'S': 'E', 'T': 'B', 'U': 'R', 'V': 'V', 'W': 'W', 'X': 'A', 'Y': 'N', 'Z': 'P'}
print("".join(d[c] if c in d.keys() else c for c in s))
```

## substitution2

<https://planetcalc.com/8047/>

## transposition-trial

```python=
s = "heTfl g as iicpCTo{7F4NRP051N5_16_35P3X51N3_V6E5926A}4"
s0 = ""
s1 = ""
for idx, c in enumerate(s):
    if idx % 3 == 2:
        s0 += c
    else:
        s1 += c
ans = ""
for idx in range(len(s0)):
    ans += s0[idx] + s1[2 * idx: 2 * idx + 2]
print(ans)
```

## Vigenere

<https://cryptii.com/pipes/vigenere-cipher>

## spelling-quiz

<https://planetcalc.com/8047/>

```python=
d = {key:val for key, val in zip(string.ascii_lowercase, "sprgwhkjoqzldcuvyemnbtiafx")}
print("".join(d[c] if c in d.keys() else c for c in "brcfxba_vfr_mid_hosbrm_iprc_exa_hoav_vwcrm"))
```

## Play Nice

```python=
SQUARE_SIZE = 6

def generate_square(alphabet):
    assert len(alphabet) == pow(SQUARE_SIZE, 2)
    matrix = []
    for i, letter in enumerate(alphabet):
        if i % SQUARE_SIZE == 0:
            row = []
        row.append(letter)
        if i % SQUARE_SIZE == (SQUARE_SIZE - 1):
            matrix.append(row)
    return matrix

def get_index(letter, matrix):
    for row in range(SQUARE_SIZE):
        for col in range(SQUARE_SIZE):
            if matrix[row][col] == letter:
                return (row, col)
    print("letter not found in matrix.")
    exit()

def decrypt_pair(p, m):
    p1 = get_index(p[0], m)
    p2 = get_index(p[1], m)
    if p1[0] == p2[0]:
        return m[p1[0]][(p1[1] + SQUARE_SIZE - 1) % SQUARE_SIZE] \
                + m[p2[0]][(p2[1] + SQUARE_SIZE - 1) % SQUARE_SIZE]
    elif p1[1] == p2[1]:
        return m[(p1[0] + SQUARE_SIZE - 1) % SQUARE_SIZE][p1[1]] \
                + m[(p2[0] + SQUARE_SIZE - 1) % SQUARE_SIZE][p2[1]]
    else:
        return m[p1[0]][p2[1]] + m[p2[0]][p1[1]]

def decrypt_string(s, m):
    result = ""
    for i in range(0, len(s), 2):
        result += decrypt_pair(s[i:i + 2], m)
    return result

alpha = "0uxtb3w4kj26q9m8gioe7nvahplr5dy1fzcs"
enc_txt = "xj5c181ropf5xjmyujnv0wlqrjdrbz"

mtx = generate_square(alpha)
print(decrypt_string(enc_txt, mtx))
```

## Double DES

<https://en.wikipedia.org/wiki/Data_Encryption_Standard>

<https://en.wikipedia.org/wiki/Meet-in-the-middle_attack>

```python=
from tqdm import tqdm
import itertools
from Crypto.Cipher import DES
import string
import binascii

def pad(msg):
    block_len = 8
    over = len(msg) % block_len
    pad = block_len - over
    return (msg + " " * pad).encode()

enc = "c6bcd08b6a5018298ae6fc40bbb45549f1be2120daf9652526a60b7eeb69adfaa767165fea47f672"

plain = pad(binascii.unhexlify("01234567").decode())
enc_plain = "861c7c50c6d1342e"

k0_candidate = {DES.new(pad("".join(k0)), DES.MODE_ECB).encrypt(plain):pad("".join(k0))
                for k0 in tqdm(itertools.product(string.digits, repeat=6))}

for k1 in tqdm(itertools.product(string.digits, repeat=6)):
    k1 = pad("".join(k1))
    cipher1 = DES.new(k1, DES.MODE_ECB)
    dec = cipher1.decrypt(binascii.unhexlify(enc_plain))
    if dec in k0_candidate.keys():
        k0 = k0_candidate[dec]
        cipher0 = DES.new(k0, DES.MODE_ECB)
        print(cipher0.decrypt(cipher1.decrypt(binascii.unhexlify(enc))))
        break
```

## la cifra de

<https://www.guballa.de/vigenere-solver>

## miniRSA

```python=
from Crypto.Util.number import long_to_bytes
import gmpy2

N = 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
c = 2205316413931134031074603746928247799030155221252519872650080519263755075355825243327515211479747536697517688468095325517209911688684309894900992899707504087647575997847717180766377832435022794675332132906451858990782325436498952049751141
e = 3

for i in range(100000):
    x = i * N + c
    y, b = gmpy2.iroot(x, 3)
    if b:
        print(long_to_bytes(y))
```

## b00tl3gRSA2

Wiener Attack

```python=
import owiener
from Crypto.Util.number import long_to_bytes

c = 38774970186940449649194127873803473789720262472766626908391587132461783629284815299124636034912379976995488726116308082504726078525327168678200637949274859154353436101506783473582288907370303430866707348436723956142432213699088028603693988269578966259753378879712230851031587696587089336697437492219889036101
n = 84525283600355054800351137598491420696865358035204610218537420080164846362254364894441677496185239993793423400045362926675583820395181150674346886481556612590332943659131464999491571818923256257136841319947877884898007132843591034204483680749828155387791905125237210429175358085749819129494751238192012980951
e = 77739994114698586800524362877255121136522213725528984932672559512214722665536171908652616884508926650073887862751335822028739343548528907915329248051670129375898650287057981618421968582358794475583845174662105568018537694879069217493857234470022151142672613694232588840316880356638660442679941419291609045569

d = owiener.attack(e, n)
print(long_to_bytes(pow(c, d, n)))
```

## Flags

<https://en.wikipedia.org/wiki/International_maritime_signal_flags>

## XtraORdinary

```python=
import itertools

def decrypt(enc, key):
    dec = b''
    for i in range(len(enc)):
        dec += bytes([enc[i] ^ key[i % len(key)]])
    return dec

enc = bytes.fromhex('57657535570c1e1c612b3468106a18492140662d2f5967442a2960684d28017931617b1f3637')

random_strs = [
    b'my encryption method',
    b'is absolutely impenetrable',
    b'and you will never',
    b'ever',
    b'break it'
]

for strs_num in range(0, len(random_strs) + 1):
    for strs_com in itertools.combinations(random_strs, strs_num):
        tmp = enc
        for strs in strs_com:
            tmp = decrypt(tmp, strs)
        print(strs_com, decrypt(tmp[:8], b'picoCTF{'))

real_strs = (b'and you will never', b'ever', b'break it')
secret_key = b'Africa!'

tmp = enc
for s in real_strs:
    tmp = decrypt(tmp, s)

print(decrypt(tmp, secret_key))
```

## triple-secure

```python=
from Crypto.Util.number import long_to_bytes, inverse, GCD
n1 = 15192492059814175574941055248891268822162533520576381643453916855435310880285336743521199057138647926712835561752909538944229702432795423884081992987060760867003375755338557996965825324749221386675061886921763747311599846248565297387814717840084998677273427776535730840343260681623323972936404815862969684384733188827100528542007213405382537935243645704237369770300643318878176739181891072725262069278646319502747718264711249767568106460533935904219027313131270918072460753061248221785076571054217566164086518459844527639082962818865640864990672033657423448004651989761933295878220596871163544315057550871764431562609
n2 = 15896482259608901559307142941940447232781986632502572991096358742354276347180855512281737388865155342941898447990281534875563129451327818848218781669275420292448483501384399236235069545630630803245125324540747189305877026874280373084005881976783826855683894679886076284892158862128016644725623200756074647449586448311069649515124968073653962156220351541159266665209363921681260367806445996085898841723209546021525012849575330252109081102034217511126192041193752164593519033112893785698509908066978411804133407757110693612926897693360335062446358344787945536573595254027237186626524339635916646549827668224103778645691
n3 = 16866741024290909515057727275216398505732182398866918550484373905882517578053919415558082579015872872951000794941027637288054371559194213756955947899010737036612882434425333227722062177363502202508368233645194979635011153509966453453939567651558628538264913958577698775210185802686516291658717434986786180150155217870273053289491069438118831268852205061142773994943387097417127660301519478434586738321776681183207796708047183864564628638795241493797850819727510884955449295504241048877759144706319821139891894102191791380663609673212846473456961724455481378829090944739778647230176360232323776623751623188480059886131
e = 65537
c = 5527557130549486626868355638343164556636640645975070563878791684872084568660950949839392805902757480207470630636669246237037694811318758082850684387745430679902248681495009593699928689084754915870981630249821819243308794164014262751330197659053593094226287631278905866187610594268602850237495796773397013150811502709453828013939726304717253858072813654392558403246468440154864433527550991691477685788311857169847773031859714215539719699781912119479668386111728900692806809163838659848295346731226661208367992168348253106720454566346143578242135426677554444162371330348888185625323879290902076363791018691228620744490

p = GCD(n1, n2)
q = GCD(n1, n3)
r = GCD(n2, n3)

ns = [n3, n2, n1]
ds = [inverse(e, (q - 1) * (r - 1)),
     inverse(e, (p - 1) * (r - 1)),
     inverse(e, (p - 1) * (q - 1))]

for n, d in zip(ns, ds):
    c = pow(c, d, n)

print(long_to_bytes(c))
```

## Tapping

<https://en.wikipedia.org/wiki/Morse_code>

```python=
flag = ".--. .. -.-. --- -.-. - ..-. { -- ----- .-. ... ...-- -.-. ----- -.. ...-- .---- ... ..-. ..- -. .---- ..--- -.... .---- ....- ...-- ---.. .---- ---.. .---- }"
d = {'.-':'A',
     '-...':'B',
     '-.-.':'C',
     '-..':'D',
     '.':'E',
     '..-.':'F',
     '--.':'G',
     '....':'H',
     '..':'I',
     '.---':'J',
     '-.-':'K',
     '.-..':'L',
     '--':'M',
     '-.':'N',
     '---':'O',
     '.--.':'P',
     '--.-':'Q',
     '.-.':'R',
     '...':'S',
     '-':'T',
     '..-':'U',
     '...-':'V',
     '.--':'W',
     '-..-':'X',
     '-.--':'Y',
     '--..':'Z',
     '.----':'1',
     '..---': '2',
     '...--':'3',
     '....-':'4',
     '.....':'5',
     '-....':'6',
     '--...':'7',
     '---..':'8',
     '----.':'9',
     '-----':'0'}
print("".join(d[c] if c in d.keys() else c for c in flag.split()))
```

## Mr-Worldwide

google map

flag: `picoCTF{KODIAK_ALASKA}`

## college-rowing-team

```python=
import gmpy2
from Crypto.Util.number import long_to_bytes

def decrypt(n, e, c):
    for i in range(1000):
        x = n * i + c
        y, b = gmpy2.iroot(x, e)
        if b:
            print(long_to_bytes(y))
            break
    else:
        print("FAILED")
n = 12426348204210593270343924563278821305386892683425418957350363905840484905896816630189546938112358425679727243103082954824537007026886458498690134225705484501535835385800730412220192564706251228021192115494699150390312107794005569764411063907390563937247515046052549753641884721864426154021041082461015103337120756347692245843318676049947569653604616584167536958803278688355036036887022591104659059883622072052793378468850702811804337808760402077376453702190206077039468600466511349923882037572540505571672225260106649075841827340894515208811788428239691505001675042096850318994923571686175381862745049100863883977473
e = 3
c = 5065488652323342174251548936130018278628515304559137485528400780060697119682927936946069625772269234638180036633146283242714689277793018059046463458498115311853401434289264038408827377579534270489217094049453933816452196508276029690068611901872786195723358744119490651499187556193711866091991489262948739533990000464588752544599393
decrypt(n, e, c)

n = 19928073532667002674271126242460424264678302463110874370548818138542019092428748404842979311103440183470341730391245820461360581989271804887458051852613435204857098017249255006951581790650329570721461311276897625064269097611296994752278236116594018565111511706468113995740555227723579333780825133947488456834006391113674719045468317242000478209048237262125983164844808938206933531765230386987211125968246026721916610034981306385276396371953013685639581894384852327010462345466019070637326891690322855254242653309376909918630162231006323084408189767751387637751885504520154800908122596020421247199812233589471220112129
e = 3
c = 86893891006724995283854813014390877172735163869036169496565461737741926829273252426484138905500712279566881578262823696620415864916590651557711035982810690227377784525466265776922625254135896966472905776613722370871107640819140591627040592402867504449339363559108090452141753194477174987394954897424151839006206598186417617292433784471465084923195909989
decrypt(n, e, c)

n = 13985338100073848499962346750699011512326742990711979583786294844886470425669389469764474043289963969088280475141324734604981276497038537100708836322845411656572006418427866013918729379798636491260028396348617844015862841979175195453570117422353716544166507768864242921758225721278003979256590348823935697123804897560450268775282548700587951487598672539626282196784513553910086002350034101793371250490240347953205377022300063974640289625028728548078378424148385027286992809999596692826238954331923568004396053037776447946561133762767800447991022277806874834150264326754308297071271019402461938938062378926442519736239
e = 3
c = 86893891006724995283854813014390877172735163869036169496565461737741926829273252426484138905500712279566881578262823696620415864916590651557711035982810690227377784525466265776922625254135896966472905776613722370871107640819140591627040592402867504449339363559108090452141753194477174987394954897424151839006206598186417617292433784471465084923195909989
decrypt(n, e, c)

n = 19594695114938628314229388830603768544844132388459850777761001630275366893884362012318651705573995962720323983057152055387059580452986042765567426880931775302981922724052340073927578619711314305880220746467095847890382386552455126586101506301413099830377279091457182155755872971840333906012240683526684419808580343325425793078160255607072901213979561554799496270708954359438916048029174155327818898336335540262711330304350220907460431976899556849537752397478305745520053275803008830388002531739866400985634978857874446527750647566158509254171939570515941307939440401043123899494711660946335200589223377770449028735883
e = 3
c = 5065488652323342174251548936130018278628515304559137485528400780060697119682927936946069625772269234638180036633146283242714689277793018059046463458498115311853401434289264038408827377579534270489217094049453933816452196508276029690068611901872786195723358744119490651499187556193711866091991489262948739533990000464588752544599393
decrypt(n, e, c)

n = 12091176521446155371204073404889525876314588332922377487429571547758084816238235861014745356614376156383931349803571788181930149440902327788407963355833344633600023056350033929156610144317430277928585033022575359124565125831690297194603671159111264262415101279175084559556136660680378784536991429981314493539364539693532779328875047664128106745970757842693549568630897393185902686036462324740537748985174226434204877493901859632719320905214814513984041502139355907636120026375145132423688329342458126031078786420472123904754125728860419063694343614392723677636114665080333174626159191829467627600232520864728015961207
e = 3
c = 301927034179130315172951479434750678833634853032331571873622664841337454556713005601858152523700291841415874274186191308636935232309742600657257783870282807784519336918511713958804608229440141151963841588389502276162366733982719267670094167338480873020791643860930493832853048467543729024717103511475500012196697609001154401
decrypt(n, e, c)

n = 19121666910896626046955740146145445167107966318588247850703213187413786998275793199086039214034176975548304646377239346659251146907978120368785564098586810434787236158559918254406674657325596697756783544837638305550511428490013226728316473496958326626971971356583273462837171624519736741863228128961806679762818157523548909347743452236866043900099524145710863666750741485246383193807923839936945961137020344124667295617255208668901346925121844295216273758788088883216826744526129511322932544118330627352733356335573936803659208844366689011709371897472708945066317041109550737511825722041213430818433084278617562166603
e = 3
c = 38999477927573480744724357594313956376612559501982863881503907194813646795174312444340693051072410232762895994061399222849450325021561935979706475527169503326744567478138877010606365500800690273
decrypt(n, e, c)

n = 13418736740762596973104019538568029846047274590543735090579226390035444037972048475994990493901009703925021840496230977791241064367082248745077884860140229573097744846674464511874248586781278724368902508880232550363196125332007334060198960815141256160428342285352881398476991478501510315021684774636980366078533981139486237599681094475934234215605394201283718335229148367719703118256598858595776777681347337593280391052515991784851827621657319164805164988688658013761897959597961647960373018373955633439309271548748272976729429847477342667875183958981069315601906664672096776841682438185369260273501519542893405128843
e = 3
c = 38999477927573480744724357594313956376612559501982863881503907194813646795174312444340693051072410232762895994061399222849450325021561935979706475527169503326744567478138877010606365500800690273
decrypt(n, e, c)

n = 11464859840071386874187998795181332312728074122716799062981080421188915868236220735190397594058648588181928124991332518259177909372407829352545954794824083851124711687829216475448282589408362385114764290346196664002188337713751542277587753067638161636766297892811393667196988094100002752743054021009539962054210885806506140497869746682404059274443570436700825435628817817426475943873865847012459799284263343211713809567841907491474908123827229392305117614651611218712810815944801398564599148842933378612548977451706147596637225675719651726550873391280782279097513569748332831819616926344025355682272270297510077861213
e = 3
c = 38999477927573480744724357594313956376612559501982863881503907194813646795174312444340693051072410232762895994061399222849450325021561935979706475527169503326744567478138877010606365500800690273
decrypt(n, e, c)

n = 21079224330416020275858215994125438409920350750828528428653429418050688406373438072692061033602698683604056177670991486330201941071320198633550189417515090152728909334196025991131427459901311579710493651699048138078456234816053539436726503461851093677741327645208285078711019158565296646858341000160387962592778531522953839934806024839570625179579537606629110275080930433458691144426869886809362780063401674963129711723354189327628731665487157177939180982782708601880309816267314061257447780050575935843160596133370063252618488779123249496279022306973156821343257109347328064771311662968182821013519854248157720756807
e = 3
c = 301927034179130315172951479434750678833634853032331571873622664841337454556713005601858152523700291841415874274186191308636935232309742600657257783870282807784519336918511713958804608229440141151963841588389502276162366733982719267670094167338480873020791643860930493832853048467543729024717103511475500012196697609001154401
decrypt(n, e, c)

n = 22748076750931308662769068253035543469890821090685595609386711982925559973042348231161108618506912807763679729371432513862439311860465982816329852242689917043600909866228033526990181831690460395726449921264612636634984917361596257010708960150801970337017805161196692131098507198455206977607347463663083559561805065823088182032466514286002822511854823747204286303638719961067031142962653536148315879123067183501832837303731109779836127520626791254669462630052241934836308543513534520718206756591694480011760892620054163997231711364648699030108110266218981661196887739673466188945869132403569916138510676165684240183111
e = 3
c = 5065488652323342174251548936130018278628515304559137485528400780060697119682927936946069625772269234638180036633146283242714689277793018059046463458498115311853401434289264038408827377579534270489217094049453933816452196508276029690068611901872786195723358744119490651499187556193711866091991489262948739533990000464588752544599393
decrypt(n, e, c)

n = 15211900116336803732344592760922834443004765970450412208051966274826597749339532765578227573197330047059803101270880541680131550958687802954888961705393956657868884907645785512376642155308131397402701603803647441382916842882492267325851662873923175266777876985133649576647380094088801184772276271073029416994360658165050186847216039014659638983362906789271549086709185037174653379771757424215077386429302561993072709052028024252377809234900540361220738390360903961813364846209443618751828783578017709045913739617558501570814103979018207946181754875575107735276643521299439085628980402142940293152962612204167653199743
e = 3
c = 301927034179130315172951479434750678833634853032331571873622664841337454556713005601858152523700291841415874274186191308636935232309742600657257783870282807784519336918511713958804608229440141151963841588389502276162366733982719267670094167338480873020791643860930493832853048467543729024717103511475500012196697609001154401
decrypt(n, e, c)

n = 21920948973299458738045404295160882862610665825700737053514340871547874723791019039542757481917797517039141169591479170760066013081713286922088845787806782581624491712703646267369882590955000373469325726427872935253365913397944180186654880845126957303205539301069768887632145154046359203259250404468218889221182463744409114758635646234714383982460599605335789047488578641238793390948534816976338377433533003184622991479234157434691635609833437336353417201442828968447500119160169653140572098207587349003837774078136718264889636544528530809416097955593693611757015411563969513158773239516267786736491123281163075118193
e = 3
c = 86893891006724995283854813014390877172735163869036169496565461737741926829273252426484138905500712279566881578262823696620415864916590651557711035982810690227377784525466265776922625254135896966472905776613722370871107640819140591627040592402867504449339363559108090452141753194477174987394954897424151839006206598186417617292433784471465084923195909989
decrypt(n, e, c)
```

## waves over lambda

https://planetcalc.com/8047/

```python=
d = {k:val for k, val in zip(string.ascii_lowercase, 'prjulvygwbskfqtixncodehazm')}
"".join(d[c] if c in d.keys() else c for c in "strhbxok wvbv pk gtdb mexh - mbvndvrsg_pk_s_tfvb_exzjux_xhmeshogdv")
```

## Compress and Attack

<https://zh.wikipedia.org/zh-tw/Salsa20>
<https://ctftime.org/writeup/27105>

```python==
import pwn
import string
from tqdm import tqdm

candidates = (string.ascii_uppercase \
                + string.ascii_lowercase
                + '_{}').encode()
r = pwn.remote("mercury.picoctf.net", "29350")
flag = b'picoCTF{'

for _ in range(30):
    mn = float('inf')
    c = b''
    for candidate in tqdm(candidates):
        try:
            r.sendlineafter(b'Enter your text to be encrypted: ',
                            flag + chr(candidate).encode())
            r.recvline()
            r.recvline()
            l = int(r.recvline().decode())
            if l < mn:
                mn = l
                c = chr(candidate).encode()
        except EOFError:
            r = pwn.remote("mercury.picoctf.net", "29350")
            r.sendlineafter(b'Enter your text to be encrypted: ',
                            flag + chr(candidate).encode())
            r.recvline()
            r.recvline()
            l = int(r.recvline().decode())
            if l < mn:
                mn = l
                c = chr(candidate).encode()

    flag += c
    print(mn, flag)

r.close()
```

## Scrambled: RSA

```python=
import string
import pwn
from tqdm import tqdm

r = pwn.remote('mercury.picoctf.net', '6276')
enc_flag = r.recvline().split(b' ')[-1].decode().rstrip()
r.recvline()
r.recvline()

flag = ''
segs = []

def rm_segs(s, segs):
    for seg in segs:
        s = s.replace(seg, '')
    return s

for c in 'picoCTF{':
    r.sendlineafter(b'I will encrypt whatever you give me:',
                    (flag + c).encode())
    r.recvuntil(b'Here you go: ')
    enc_part = r.recvline().decode().strip()
    seg = rm_segs(enc_part, segs)
    segs.append(seg)
    flag += c

while True:
    for c in '_{}' + string.digits + string.ascii_letters:
        r.sendlineafter(b'I will encrypt whatever you give me:', (flag + c).encode())
        enc_part = r.recvline().split(b' ')[-1].decode().rstrip()
        seg = rm_segs(enc_part, segs)
        if seg in enc_flag:
            flag += c
            segs.append(seg)
            break
    else:
        print('FAILED')
        break
    print(flag)
    if flag[-1] == '}':
        break
```

## Sum-O-Primes

```python=
import gmpy2
from Crypto.Util.number import long_to_bytes

x = int('152d9ba0e29726ebde4be1776a89d6f3b57d30e984094ad04ba67e953bc08d77240e7448abba56672e34e6197ca85e8b3f0d0191b46aa78acf453b4fec97636a0ab7614c2e17a1f7b75ff5e44e977e6ad88250a4a05f765f7742d251e52c6cb9d48d85c3760afd758b87293e521ca46f5fcdc9793fab94a59152e331168a5f774', 16)
n = int('7014563c9ab9706ebd55273d2bfa3b69ef510decf2b7e414da3473adc3e6d4e293b11408724b4a132888aaf5c5fc7e89923c0e2e5362789b5d596ca1977ee9570bd69c7273925672ceabbbca5d6f4a50916b308f2dd4a836c4dc1777da278e5b3dd9e9c94294ab2f263f1fd485a6bd50b9e0d8e2e37117970e2250bd361bf6ce2423f7e7eb3eb47fda627a01399e21eb7c3c577e3ffd27c90fda0b9b9fce20afb708f583a9063ffd899768d8344297b847f1c66ba204745d063c5cf4f740f3e689963f677183e0210dd04e6d95649441925e740b5fa6e3dea7cb91697e946645e6aa4c439503cd1b7411ada408f0714ac2278a5f8224215b1d21be60cc817973', 16)
c = int('6ac1c74bf48c830b1ce48c7db010743d06287d3af0e4c390eaf7a59f885012e9e10ed9b7390bb870d544a602f24114aa8d7a8ed584e99f157541af647321819df20f2287f735480700e883db6179aa5affd0990e4b56df2c73784f1484b546c90dfa7c8132a39976fc74c4c63497605ab694db2dc14585f93e03329b44acd1aabd9dc53d5fe958f110556dad953d59f23892cb481adb1ff0b5ee967877180bf6da3ce4a32a0c80c383f576d247b9e7f3d6c81c85c587a538b814bbb73330b0537f5e3279024dcd2d6842ce1789f6f90221fbe1555a386085a5f7d1cfe7c363674a8aa6c372a877948e7a6dee66b62d8b812375f6012ce81bf13e5147915ca61a', 16)
e = 65537

y = gmpy2.isqrt((x ** 2) - 4 * n)

p = (x + y) // 2
q = abs(x - y) // 2
print(x == p + q, n == p * q)
d = pow(e, -1, (p - 1) * (q - 1))
print(long_to_bytes(pow(c, d, n)))
```

## john_pollard

<https://stackoverflow.com/questions/10271197/how-to-extract-public-key-using-openssl>
<factordb.com>

```bash
openssl x509 -noout -text -in cert
```

## b00tl3gRSA3


```python==
import pwn
from Crypto.Util.number import inverse, long_to_bytes
from sympy.ntheory import factorint

r = pwn.remote("jupiter.challenges.picoctf.org", "3726")
c = int(r.recvline().split(b' ')[-1].decode())
n = int(r.recvline().split(b' ')[-1].decode())
e = int(r.recvline().split(b' ')[-1].decode())
r.close()
fc = factorint(n)

r = 1
for key in fc.keys():
    r *= (key - 1) ** (fc[key])
d = inverse(e, r)
print(long_to_bytes(pow(c, d, n)))
```

## Very Smooth

p - 1 has small factors(ie. B-smooth) $\rightarrow$ Pollar's attack

```python=
import math
from Crypto.Util.number import inverse, long_to_bytes

def pollard(n):
    a = 2
    b = 2
    while True:
        a = pow(a, b, n)
        d = math.gcd(a - 1, n)
        if 1 < d < n:
            return d
        b += 1

n = int('6df1b3e09c344f8cf16c6fd9bdcc140e7c7c44c1ffd9c8439aa28599bf4f5691ab107314d51194dff5b3b6dcfd84d03e8067eee1bc2554f10ecae55beb6b4f7406b1a76790e30f1a5688edf773f0dfb65477270054fedf94f21bfabaa5781200974a5c7fa1c863fccf8689a8a13302d1a861f82c678604a73400b4ab1532eec5472c56720fbe336e24a7e855a5b46a8a7b64224c8be263fef1c8eb263f6e6690a41648077aa6629956f719bb4150e411d6d1e04d61347710596f988d91dcf306e44688f1919f860c56508d1079f994cd45e0d8305ea1d2211d1579a2c90e6bf155672a4d893e981f579b4942af50ed2ce18bcb3625b16a4cf9d2b7cf195f1f85', 16)

c = int('527d16b8a5e8a99a8138331b94ef1f8bed77fcdc27c4a664ef7495b72ea90a26c9a17e3d62db612fb8176a9ae8687f8c16b43c0fe279837b8e63aac96b8b170aa5e24a852c1ae60bb948e15c60155672ac6c8d0d789e4bb186102c4b8aebf1b88acb250da8ed7c6dc244c44b8ec458ca55d09884ab8db3bbc544e3cacab7a6eb8fbe6c267cc496317a4fbe6dbb32681211c1ffb0b5da4e84035306ff4abd7c53e5f6247073bbf5d656a2d700263bee67c43d1c8c842e631fde93aefae78b09bd62239620b80e0caa0d43b5e7a779bbaae669b14d9da819f1707619e12604c92641a64519275a8ba824d4c90e088708b59cb8ee8ce3729e1f3b6eb6359cb706ad', 16)

e = 65537

p = pollard(n)
q = n // p
d = inverse(e, (p - 1) * (q - 1))
print(long_to_bytes(pow(c, d, n)))
```